# 분석 및 통계 기능 명세서

## 🎯 기능 개요
사용자의 행복 기록과 수면 데이터를 종합 분석하여 개인화된 인사이트와 패턴을 제공하는 데이터 분석 시스템

## 📊 주요 기능

### 🔍 개인 인사이트 대시보드
**목적**: 개인의 웰빙 패턴을 한눈에 파악할 수 있는 통합 뷰 제공

**핵심 지표**:
- **웰빙 스코어**: 행복도와 수면질을 종합한 개인 점수
- **이번 주 vs 지난 주**: 주요 지표들의 변화율
- **개선 영역**: 가장 발전 가능성이 높은 영역 식별
- **강점 영역**: 잘 관리되고 있는 영역 하이라이트

**시각적 표현**:
- 방사형 차트로 다차원 웰빙 상태 표시
- 색상 코딩된 트렌드 인디케이터
- 주요 숫자 지표의 큰 텍스트 표시

### 📈 감정 패턴 분석
**목적**: 감정 변화의 패턴과 트리거를 찾아 예측 가능한 인사이트 제공

**분석 차원**:

**시간별 패턴**:
- 요일별 감정 분포 (월요병, 금요일 신나는 기분 등)
- 시간대별 감정 변화 (아침/점심/저녁 패턴)
- 계절별/월별 장기 트렌드

**상황별 패턴**:
- 태그별 감정 강도 분석 (업무/가족/친구 상황별)
- 장소별 행복도 분석 (집/회사/카페 등)
- 활동별 만족도 순위

**상관관계 분석**:
- 날씨와 감정의 관계
- 수면시간과 다음날 행복도의 상관성
- 특정 활동 후 감정 변화 패턴

### 🛏️ 수면 패턴 분석
**목적**: 개인 최적 수면 패턴 발견 및 수면 질 개선 방향 제시

**분석 영역**:

**개인 수면 프로필**:
- 수면 타입 판별 (아침형/저녁형)
- 개인 최적 수면시간 (7-9시간 중 개인별 스윗스팟)
- 수면 효율성 트렌드

**수면질 영향 요인**:
- 취침 시간과 수면 만족도의 관계
- 수면 방해 요인별 영향도 분석
- 주중 vs 주말 수면 패턴 차이

**수면-컨디션 연결고리**:
- 수면 시간과 다음날 피로도 상관관계
- 수면질과 감정 안정성의 관계
- 수면 부족이 행복도에 미치는 영향

### 🎯 목표 달성 추적
**목적**: 개인 목표 설정 및 달성 과정의 체계적 관리

**추적 지표**:
- 7일 챌린지 완주율 및 성과
- 월별/분기별 개선도 측정
- 개인 맞춤 목표 진행률

**성취 시각화**:
- 달성률 원형 차트
- 마일스톤 타임라인
- 스트릭 표시 (연속 달성 일수)

## 🏗️ 기술적 구현사항

### 데이터 분석 엔진
```dart
class AnalyticsEngine {
  // 기본 통계 계산
  PersonalInsights calculatePersonalInsights(
    List<EmotionRecord> emotions,
    List<SleepRecord> sleeps
  );
  
  // 패턴 분석
  EmotionPattern analyzeEmotionPattern(
    List<EmotionRecord> records,
    AnalysisPeriod period
  );
  
  // 상관관계 분석
  CorrelationResult analyzeSleepEmotionCorrelation(
    List<EmotionRecord> emotions,
    List<SleepRecord> sleeps
  );
  
  // 예측 및 추천
  List<Recommendation> generateRecommendations(
    PersonalInsights insights
  );
}
```

### 데이터 모델
```dart
class PersonalInsights {
  double wellbeingScore;      // 0-100 점수
  Map<String, double> categoryScores; // 수면, 감정, 활동별 점수
  List<Trend> weeklyTrends;
  List<Achievement> recentAchievements;
  List<String> improvementAreas;
  List<String> strengthAreas;
}

class EmotionPattern {
  Map<DayOfWeek, double> weeklyPattern;
  Map<TimeOfDay, double> dailyPattern;
  Map<String, double> tagBasedPattern;
  List<Trigger> identifiedTriggers;
}

class CorrelationResult {
  double correlationCoefficient;
  String interpretation;
  List<DataPoint> scatterPlotData;
  String recommendation;
}
```

### 실시간 분석 처리
**스트리밍 분석**:
- 새로운 기록 입력시 실시간 패턴 업데이트
- 변화 감지 알고리즘으로 중요한 변화 식별
- 임계치 기반 알림 시스템

**배치 분석**:
- 주간/월간 정기 심화 분석
- 장기 트렌드 계산 및 예측
- 개인화 추천 시스템 업데이트

## 🎨 UI/UX 가이드라인

### 대시보드 레이아웃
**상단 영역**: 핵심 KPI
- 웰빙 스코어 (큰 원형 게이지)
- 주요 지표 3개 (이번주 변화율 포함)

**중간 영역**: 트렌드 차트
- 지난 30일 감정/수면 트렌드 라인 차트
- 인터랙티브한 기간 선택기

**하단 영역**: 인사이트 카드
- 개인화된 발견사항 3-4개 카드
- 액션 아이템 추천

### 차트 디자인 원칙
**색상 체계**:
- 감정: 따뜻한 색조 (주황, 노랑, 빨강)
- 수면: 차가운 색조 (파랑, 보라, 청록)
- 통합 지표: 중성 색조 (회색, 녹색)

**애니메이션**:
- 차트 로딩시 점진적 드로우 효과
- 데이터 변경시 부드러운 전환 애니메이션
- 호버시 툴팁 페이드인/아웃

### 인사이트 표현
**발견사항 카드**:
```
💡 "화요일 오후에 가장 행복해하시네요!"
   지난 4주간 화요일 오후 평균 4.2점

📊 자세히 보기 →
```

**추천 카드**:
```
🎯 "30분 일찍 잠들어보세요"
   평소보다 30분 일찍 잠든 날, 다음날 
   행복도가 평균 0.8점 높았어요

✨ 시도해보기 →
```

## 📊 분석 알고리즘

### 패턴 감지 알고리즘
**시계열 분석**:
- 이동평균으로 노이즈 제거
- 계절성 분해를 통한 주기 패턴 추출
- 이상치 탐지 및 특별한 이벤트 식별

**클러스터링**:
- 유사한 감정 상태의 날들을 그룹핑
- 수면 패턴의 타입별 분류
- 사용자 행동 패턴 세그멘테이션

### 추천 시스템
**협업 필터링**:
- 유사한 패턴을 가진 다른 사용자의 성공 사례 활용
- 개인화된 활동/시간 추천

**콘텐츠 기반 필터링**:
- 개인의 과거 성공 패턴 분석
- 선호하는 활동/시간대 기반 추천

### 예측 모델
**단기 예측 (1-7일)**:
- 날씨, 일정 등 외부 요인 고려
- 개인 바이오리듬 기반 감정/컨디션 예측

**장기 예측 (1-3개월)**:
- 계절적 요인 고려
- 라이프스타일 변화 트렌드 반영

## 🔒 개인정보 보호

### 데이터 처리 원칙
- 모든 분석은 개인 기기/계정 내에서 수행
- 집계된 익명 데이터만 추천 시스템에 활용
- 사용자 동의하에만 추가 분석 수행

### 투명성 확보
- 분석 방법과 근거 명시
- 데이터 사용 범위 명확화
- 분석 결과에 대한 신뢰도 표시

## 🚀 향후 확장 기능
- **AI 기반 예측**: 머신러닝을 활용한 정확한 웰빙 상태 예측
- **외부 데이터 연동**: 날씨, 달력, 건강앱 등과의 통합 분석
- **벤치마킹**: 익명화된 그룹별 비교 분석
- **전문가 해석**: 심리학/수면의학 전문가의 해석 제공
- **실시간 대시보드**: 라이브 스트리밍 방식의 실시간 상태 모니터링