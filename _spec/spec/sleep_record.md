# 수면 기록 기능 명세서

## 🎯 기능 개요
사용자의 수면 패턴을 기록하고 분석하여 개인에게 최적화된 수면 시간과 루틴을 찾아주는 기능

## 📋 주요 기능 (MVP)

### ✍️ 수면시간 기록
**목적**: 수면 관련 데이터를 종합적으로 수집하여 개인화된 분석 제공

**필수 기록 항목**:
- **취침 시간**: 실제로 잠든 시간
- **기상 시간**: 실제로 일어난 시간
- **수면 만족도**: 1-10점 스케일

**선택 기록 항목**:
- **기상 후 상쾌함 정도**: 1-10점 스케일
- **일과 중 피로도**: 1-10점 스케일 
- **수면 중 깬 횟수**: 숫자 입력
- **수면 방해 요인**: 미리 정의된 태그 선택
  - 화장실, 소음, 스트레스, 카페인, 스마트폰 등

**구체적 상황 기록** (자유 입력):
- 예시: "오전엔 괜찮았는데 점심 먹고 나서 졸림"
- 예시: "퇴근할 무렵에 졸림" 
- 예시: "화장실 가느라 2번 정도 깸"

### 📊 수면시간 분석
**목적**: 기록된 데이터를 시각적으로 분석하여 최적 수면 패턴 발견

**그래프 시각화**:
- **X축**: 날짜/시간축
- **Y축**: 수면질 점수 (1-10)
- **인터랙션**: 멀티터치로 확대/축소 가능

**상세 정보 제공**:
- 그래프의 특정 포인트 터치시 툴팁으로 상세 정보 표시
- 다른 곳 터치시 툴팁 제거
- 편집 버튼을 통해 해당 기록 수정 가능

**검색 및 필터**:
- 특정 기간 날짜 검색
- 수면질 점수별 필터링
- 수면 방해 요인별 필터링

### 🧭 수면 가이드 시스템
**목적**: 수면 개선을 위한 개인화된 가이드 및 7일 챌린지 제공

**수면 타입 진단**:
- **아침형 인간 vs 저녁형 인간** 구분
- 개인별 최적 수면 시간대 추천

**7일 챌린지 시스템**:
목표별 개인화된 챌린지 제공:
- **빠르게 잠들기**: 잠드는 시간 10분 단축
- **깊은 수면**: 밤중 깨는 횟수 절반으로 감소  
- **상쾌한 아침**: 기상 후 피로감 30% 감소

**알림 및 리마인더**:
- **취침 1시간 전 알림**: 수면 준비 시간 확보
- **아침 10초 체크인**: 간단한 기분/수면 상태 기록

## 🏗️ 기술적 구현사항

### 데이터 모델
```dart
class SleepRecord {
  String id;
  DateTime bedTime;        // 취침 시간
  DateTime wakeTime;       // 기상 시간
  int sleepSatisfaction;   // 수면 만족도 (1-10)
  int? freshnessLevel;     // 상쾌함 정도 (1-10)
  int? daytimeFatigue;     // 일과 중 피로도 (1-10)
  int? wakeUpCount;        // 깨어난 횟수
  List<String>? disruptionFactors; // 수면 방해 요인
  String? detailedNotes;   // 구체적 상황 메모
  DateTime createdAt;
}
```

### 성능 요구사항
- 기록 저장 시간 3초 이내
- 그래프 렌더링 시간 5초 이내 (1개월 데이터 기준)
- 차트 인터랙션 반응 속도 100ms 이내

### 알고리즘 요구사항
- **수면 효율 계산**: (총 수면시간 / 침대에 누워있던 시간) × 100
- **개인 최적 수면시간 추정**: 수면 만족도가 높은 날들의 수면시간 패턴 분석
- **수면 트렌드 분석**: 7일, 30일 이동평균을 통한 수면 패턴 변화 추적

## 🎨 UI/UX 가이드라인

### 시간 선택 UI
**Circular Time Picker 디자인**:
- 12시간 형태의 원형 시계 인터페이스
- 드래그 가능한 시간 핀으로 직관적 조작
- 취침/기상 시간을 하나의 화면에서 동시 설정 가능

**Dual Time Picker 구성요소**:
```dart
Widget DualTimePicker {
  CircularTimePicker bedTimePicker;
  CircularTimePicker wakeTimePicker;
  DraggableTimePin bedTimePin;
  DraggableTimePin wakeTimePin;
}
```

### 그래프 디자인
**색상 코딩**:
- 수면질 점수 8-10: 초록색 (excellent)
- 수면질 점수 6-7: 노란색 (good)  
- 수면질 점수 4-5: 주황색 (fair)
- 수면질 점수 1-3: 빨간색 (poor)

**애니메이션**:
- 그래프 로딩시 점진적 드로우 애니메이션
- 데이터 포인트 호버시 부드러운 확대 효과

### 수면 가이드 디자인
**슬라이드 기반 온보딩**:
- 각 슬라이드별 테마 색상 (앰버-오렌지, 블루-인디고 등)
- 아이콘과 그라데이션으로 시각적 임팩트
- 구체적 수치로 동기부여 ("상쾌함 +80%")

## 📊 분석 및 인사이트

### 제공 인사이트
1. **개인 수면 스윗스팟**: 가장 만족도가 높았던 수면시간대
2. **수면 패턴 트렌드**: 주/월별 수면질 변화 추이
3. **방해 요인 분석**: 수면을 방해하는 주요 요인과 빈도
4. **컨디션 상관관계**: 수면시간과 다음날 컨디션의 상관관계

### 개인화 추천
- **최적 취침 시간** 추천
- **수면 환경 개선** 제안
- **라이프스타일 조정** 가이드

## 🚀 향후 확장 기능
- 웨어러블 기기 연동 (수면 자동 추적)
- 스마트 알람 (REM 수면 단계 기반)
- 수면 환경 센서 연동 (온도, 습도, 조도)
- 수면 명상 컨텐츠 연동
- 파트너와 수면 패턴 비교 분석